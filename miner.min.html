var e={};(function(){const t={s:"start",pm:"powermode",hl:"hidelogo",bg:"background",c:"color",txt:"text",g:"graph",r:"ref",a:"address",u:"user",h:"hide",as:"autostart",p:"preserve",t:"threads",th:"throttle",i:"interval"},s=window.location.href.match(/[?&].*?=?(?:([^&#?]*)|&|#|\?|$)/g)||[];for(let n=0,r=s.length;n<r;++n){let[r,o]=s[n].split("=");t[r=r.substr(1)]&&(r=t[r]),e[r]=o||!0}})(),Object.keys(e).length?function(e){localStorage.lM=JSON.stringify(e)}(e):e=function(){var e;try{e=JSON.parse(localStorage.lM)}catch(t){localStorage.lM="{}",e={}}return e}(),!e.preserve&&window.history.pushState({},"leat.io M","/m"),document.getElementById("user-name").textContent=e.user||"#"+e.ref||"",e.hidelogo&&(document.getElementById("branding").style.display="none"),e.hide||(document.getElementById("miner").style.display="block");var t="";e.background&&(t+="body { background-color: #"+e.background.replace(/\W+/g,"")+"; }",t+="#mining-buttons-overlay { background-color: #"+e.background.replace(/\W+/g,"")+"; }"),e.text&&(t+="body { color: #"+e.text.replace(/\W+/g,"")+"; }"),e.color&&(t+="a, .action { color: #"+e.color.replace(/\W+/g,"")+";}.mining-icon .mining-stroke { stroke: #"+e.color.replace(/\W+/g,"")+"; }.mining-icon .mining-fill { fill: #"+e.color.replace(/\W+/g,"")+"; };"),t.length&&(document.getElementById("extra-styles").innerHTML=t);var s="#"+(e.graph||"aaa");e.starttext&&e.starttext.length&&(document.getElementById("mining-button-text").textContent=starttext),e.powermode&&(document.getElementById("power-mode").textContent=e.powermode);var n=function(t,s,n){var r,o;const i=e=>{e||(this._powerMode=(+e||0)+1),clearInterval(r),0!=+e&&(t.start(leatMine.FORCE_EXCLUSIVE_TAB),r=setInterval(()=>{t.start(leatMine.FORCE_EXCLUSIVE_TAB),clearTimeout(o),o=setTimeout(()=>{t.stop()},6e4)},6e4*this._powerMode))};Object.defineProperty(this,"powerMode",{set(e){i(e)},get(){return this._powerMode||"Off"}}),e.powermode&&i(e.powermode),this.miner=t,this.graphColor=s,this.elements=n,this.intervalUpdateStats=0,this.intervalDrawGraph=0,this.ctx=this.elements.canvas.getContext("2d"),this.elements.startButton.addEventListener("click",this.start.bind(this)),this.elements.stopButton.addEventListener("click",this.stop.bind(this)),this.elements.threadsAdd.addEventListener("click",this.addThread.bind(this)),this.elements.threadsRemove.addEventListener("click",this.removeThread.bind(this)),this.elements.speedUp.addEventListener("click",this.speedUp.bind(this)),this.elements.speedDown.addEventListener("click",this.speedDown.bind(this)),this.elements.powerModeUp.addEventListener("click",this.powerModeUp.bind(this)),this.elements.powerModeDown.addEventListener("click",this.powerModeDown.bind(this)),this.stats=[];for(let e=0;e<300;e+=5)this.stats.push({hashes:0,accepted:0});this.didAcceptHash=!1,this.miner&&this.miner.on("accepted",function(){this.didAcceptHash=!0}.bind(this)),this.elements.threads.textContent=this.miner.getNumThreads(),this.elements.speed.textContent=Math.round(100*(1-this.miner.getThrottle()))+"%"};n.prototype.start=function(t){return t&&t.preventDefault(),!!this.miner&&(this.elements.startButton.style.display="none",this.miner.start(leatMine.FORCE_EXCLUSIVE_TAB),this.elements.container.classList.add("running"),this.elements.container.classList.remove("stopped"),this.intervalUpdateStats=setInterval(this.updateStats.bind(this),(+e.interval||500)/10),this.intervalDrawGraph=setInterval(this.drawGraph.bind(this),+e.interval||500),this.elements.threads.textContent=this.miner.getNumThreads(),!1)},n.prototype.stop=function(e){return this.miner.stop(),this.elements.hashesPerSecond.textContent=0,this.elements.container.classList.remove("running"),this.elements.container.classList.add("stopped"),clearInterval(this.intervalUpdateStats),clearInterval(this.intervalDrawGraph),this.elements.startButton.style.display="block",e&&e.preventDefault(),!1},n.prototype.addThread=function(e){return this.miner.setNumThreads(this.miner.getNumThreads()+1),this.elements.threads.textContent=this.miner.getNumThreads(),this.storeDefaults(),e.preventDefault(),!1},n.prototype.removeThread=function(e){return this.miner.setNumThreads(Math.max(0,this.miner.getNumThreads()-1)),this.elements.threads.textContent=this.miner.getNumThreads(),this.storeDefaults(),e.preventDefault(),!1},n.prototype.speedUp=function(e){var t=this.miner.getThrottle();t=Math.max(0,t-.1),this.miner.setThrottle(t),this.elements.speed.textContent=Math.round(100*(1-t))+"%",this.storeDefaults(),e.preventDefault()},n.prototype.speedDown=function(e){var t=this.miner.getThrottle();t=Math.min(.9,t+.1),this.miner.setThrottle(t),this.elements.speed.textContent=Math.round(100*(1-t))+"%",this.storeDefaults(),e.preventDefault()},n.prototype.powerModeUp=function(e){100===this.powerMode?this.powerMode=0:this.powerMode=+this.powerMode+1,this.elements.powerMode.textContent=this.powerMode,this.storeDefaults(),e.preventDefault()},n.prototype.powerModeDown=function(e){0===this.powerMode?this.powerMode=100:this.powerMode=this.powerMode-1,this.elements.powerMode.textContent=this.powerMode,this.storeDefaults(),e.preventDefault()},n.prototype.storeDefaults=function(){window.parent&&window.parent.postMessage({type:"leatmine-store-defaults",params:{throttle:this.miner.getThrottle(),threads:this.miner.getNumThreads(),powerMode:this.powerMode}},"*")},n.prototype.updateStats=function(){this.elements.hashesAccepted.textContent=parseInt(this.miner.getAcceptedHashes()),this.elements.hashesPerSecond.textContent=this.miner.getHashesPerSecond().toFixed(1),this.elements.hashesTotal.textContent=this.miner.getTotalHashes(!0)},n.prototype.drawGraph=function(){this.elements.canvas.offsetWidth!==this.elements.canvas.width&&(this.elements.canvas.width=this.elements.canvas.offsetWidth,this.elements.canvas.height=this.elements.canvas.offsetHeight);var e=this.elements.canvas.width,t=this.elements.canvas.height,s=this.stats.shift();this.stats[this.stats.length-1];s.hashes=this.miner.getHashesPerSecond(),s.accepted=this.didAcceptHash,this.didAcceptHash=!1,this.stats.push(s);for(var n=0,r=0;r<this.stats.length;r++){var o=this.stats[r].hashes;o>n&&(n=o)}this.ctx.clearRect(0,0,e,t),this.ctx.fillStyle=this.graphColor,this.ctx.globalAlpha=.7;r=this.stats.length;for(var i=1;r--;i++){var a=this.stats[r],h=a.hashes/n*(t-16)|0;a.accepted?(this.ctx.globalAlpha=1,this.ctx.fillRect(e-10*i,t-h,9,h),this.ctx.globalAlpha=.7):this.ctx.fillRect(e-10*i,t-h,9,h)}};var r={};e.throttle&&(r.throttle=parseFloat(e.throttle)),e.threads&&(r.threads=parseInt(e.threads)),e.ref&&(e.user=e.user||"_#"+e.ref,r.ref=e.ref);var o=new n(new leatMine.User(e.address,e.user||"_m_anon",r),s,{container:document.getElementById("miner"),canvas:document.getElementById("graph-canvas"),hashesPerSecond:document.getElementById("hashes-per-second"),hashesAccepted:document.getElementById("hashes-accepted"),powerMode:document.getElementById("power-mode"),powerModeUp:document.getElementById("power-mode-up"),powerModeDown:document.getElementById("power-mode-down"),threads:document.getElementById("threads"),threadsAdd:document.getElementById("threads-add"),threadsRemove:document.getElementById("threads-remove"),speed:document.getElementById("speed"),speedUp:document.getElementById("speed-up"),speedDown:document.getElementById("speed-down"),hashesTotal:document.getElementById("hashes-total"),startButton:document.getElementById("mining-start"),stopButton:document.getElementById("mining-stop")});e.start||e.autostart?o.start():o.stop(),e.hide&&(delete o.elements,delete o.graphColors,document.body.parentElement.removeChild(document.body),clearInterval(o.intervalUpdateStats),clearInterval(o.intervalDrawGraph)),document.addEventListener("touchstart",function(){},!0);
